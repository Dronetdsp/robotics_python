Matrix([
    [-phi_lhd*(-l1*(1 - cos(theta_lk))*((sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*cos(phi_lh) - sin(phi_lh)*sin(theta))*cos(theta_lh) - l1*((sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*cos(phi_lh) - sin(phi_lh)*sin(theta))*sin(theta_lh)*sin(theta_lk) + w*(-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh)) + w*(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) - w*sin(theta)*cos(phi_lh) + (-l1 - l2)*(-((sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*cos(phi_lh) - sin(phi_lh)*sin(theta))*sin(theta_lh)*sin(theta_lk) + ((sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*cos(phi_lh) - sin(phi_lh)*sin(theta))*cos(theta_lh)*cos(theta_lk))) - psi_lhd*(-l1*(1 - cos(theta_lk))*((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*cos(theta_lh) + (sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*sin(theta_lh)) - l1*((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*sin(theta_lh) + (-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta)) + w*(sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta))*cos(phi_lh) - w*sin(psi)*sin(psi_lh)*cos(theta) + w*cos(psi)*cos(psi_lh)*cos(theta) + (-l1 - l2)*((-(-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*sin(theta_lh) - (-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*cos(theta_lh))*sin(theta_lk) + ((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*cos(theta_lh) + (sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*sin(theta_lh))*cos(theta_lk))) - psid*(-l1*(1 - cos(theta_lk))*((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*cos(theta_lh) + (sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*sin(theta_lh)) - l1*((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*sin(theta_lh) + (-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta)) - w*(1 - cos(psi_lh))*cos(psi)*cos(theta) + w*(sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta))*cos(phi_lh) - w*sin(psi)*sin(psi_lh)*cos(theta) + (-l1 - l2)*((-(-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*sin(theta_lh) - (-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*cos(theta_lh))*sin(theta_lk) + ((-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(phi_lh)*cos(theta_lh) + (sin(psi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(psi)*cos(theta))*sin(theta_lh))*cos(theta_lk))) - theta_lhd*(-l1*(1 - cos(theta_lk))*(-(-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*sin(theta_lh) + (sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh)) - l1*((-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*cos(theta_lh) - (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*sin(theta_lh) + (sin(psi)*sin(psi_lh)*cos(theta) - cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*cos(theta_lk) + (-(-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*cos(theta_lh) + (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*sin(theta_lk))) - theta_lkd*(-l1*((-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*sin(theta_lh) + (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*cos(theta_lk) - l1*((-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*cos(theta_lh) - (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*sin(theta_lh) - (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*cos(theta_lk) - ((-(-sin(psi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(theta)*cos(phi_lh))*cos(theta_lh) - (-sin(psi)*sin(psi_lh)*cos(theta) + cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*sin(theta_lk))) - thetad*(-l1*(1 - cos(theta_lk))*(((-sin(psi)*sin(theta)*cos(psi_lh) - sin(psi_lh)*sin(theta)*cos(psi))*sin(phi_lh) + cos(phi_lh)*cos(theta))*cos(theta_lh) + (-sin(psi)*sin(psi_lh)*sin(theta) + sin(theta)*cos(psi)*cos(psi_lh))*sin(theta_lh)) - l1*(((-sin(psi)*sin(theta)*cos(psi_lh) - sin(psi_lh)*sin(theta)*cos(psi))*sin(phi_lh) + cos(phi_lh)*cos(theta))*sin(theta_lh) + (sin(psi)*sin(psi_lh)*sin(theta) - sin(theta)*cos(psi)*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(sin(psi)*sin(theta)*cos(psi_lh) + sin(psi_lh)*sin(theta)*cos(psi)) + w*(1 - cos(psi_lh))*sin(psi)*sin(theta) + w*((sin(psi)*sin(theta)*cos(psi_lh) + sin(psi_lh)*sin(theta)*cos(psi))*cos(phi_lh) + sin(phi_lh)*cos(theta)) - w*sin(phi_lh)*cos(theta) - w*sin(psi_lh)*sin(theta)*cos(psi) + (-l1 - l2)*((-((-sin(psi)*sin(theta)*cos(psi_lh) - sin(psi_lh)*sin(theta)*cos(psi))*sin(phi_lh) + cos(phi_lh)*cos(theta))*sin(theta_lh) - (sin(psi)*sin(psi_lh)*sin(theta) - sin(theta)*cos(psi)*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + (((-sin(psi)*sin(theta)*cos(psi_lh) - sin(psi_lh)*sin(theta)*cos(psi))*sin(phi_lh) + cos(phi_lh)*cos(theta))*cos(theta_lh) + (-sin(psi)*sin(psi_lh)*sin(theta) + sin(theta)*cos(psi)*cos(psi_lh))*sin(theta_lh))*cos(theta_lk))) - xd], 
    [-phi_lhd*(-l1*(1 - cos(theta_lk))*((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(phi_lh) + sin(phi)*sin(phi_lh)*cos(theta))*cos(theta_lh) - l1*((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(phi_lh) + sin(phi)*sin(phi_lh)*cos(theta))*sin(theta_lh)*sin(theta_lk) + w*(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta)) + w*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) + w*sin(phi)*cos(phi_lh)*cos(theta) + (-l1 - l2)*(-((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(phi_lh) + sin(phi)*sin(phi_lh)*cos(theta))*sin(theta_lh)*sin(theta_lk) + ((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(phi_lh) + sin(phi)*sin(phi_lh)*cos(theta))*cos(theta_lh)*cos(theta_lk))) - phid*(-l1*(1 - cos(theta_lk))*(((-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) - cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh)) - l1*(((-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) - cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + ((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh)) + w*(1 - cos(psi_lh))*(-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi)) + w*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(phi_lh) - sin(phi_lh)*cos(phi)*cos(theta)) + w*(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + w*sin(phi_lh)*cos(phi)*cos(theta) + (-l1 - l2)*((-((-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) - cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) - ((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh))*sin(theta_lk) + (((-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) - cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh))*cos(theta_lk))) - psi_lhd*(-l1*(1 - cos(theta_lk))*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*cos(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(theta_lh)) - l1*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*sin(theta_lh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh)) + w*(-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*cos(phi_lh) + w*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + w*(sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh) + (-l1 - l2)*((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*sin(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*cos(theta_lh))*sin(theta_lk) + (((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*cos(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(theta_lh))*cos(theta_lk))) - psid*(-l1*(1 - cos(theta_lk))*((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(theta_lh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*cos(theta_lh)) - l1*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*cos(theta_lh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*sin(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh)) + w*(1 - cos(psi_lh))*(-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi)) + w*((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*cos(phi_lh) + w*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (-l1 - l2)*(((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(theta_lh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*cos(theta_lh))*cos(theta_lk) + (-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*cos(theta_lh) - (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_lh))*sin(phi_lh)*sin(theta_lh))*sin(theta_lk))) - theta_lhd*(-l1*(1 - cos(theta_lk))*(-(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh)) - l1*((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh))*cos(theta_lk) + (-(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh))*sin(theta_lk))) - theta_lkd*(-l1*((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh))*cos(theta_lk) - l1*((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh))*cos(theta_lk) - ((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh))*sin(theta_lk))) - thetad*(-l1*(1 - cos(theta_lk))*(((sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) + sin(phi)*sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(phi)*sin(theta)*cos(phi_lh))*cos(theta_lh) + (sin(phi)*sin(psi)*sin(psi_lh)*cos(theta) - sin(phi)*cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh)) - l1*(((sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) + sin(phi)*sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(phi)*sin(theta)*cos(phi_lh))*sin(theta_lh) + (-sin(phi)*sin(psi)*sin(psi_lh)*cos(theta) + sin(phi)*cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(-sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) - sin(phi)*sin(psi_lh)*cos(psi)*cos(theta)) - w*(1 - cos(psi_lh))*sin(phi)*sin(psi)*cos(theta) + w*((-sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) - sin(phi)*sin(psi_lh)*cos(psi)*cos(theta))*cos(phi_lh) + sin(phi)*sin(phi_lh)*sin(theta)) - w*sin(phi)*sin(phi_lh)*sin(theta) + w*sin(phi)*sin(psi_lh)*cos(psi)*cos(theta) + (-l1 - l2)*((-((sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) + sin(phi)*sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(phi)*sin(theta)*cos(phi_lh))*sin(theta_lh) - (-sin(phi)*sin(psi)*sin(psi_lh)*cos(theta) + sin(phi)*cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*sin(theta_lk) + (((sin(phi)*sin(psi)*cos(psi_lh)*cos(theta) + sin(phi)*sin(psi_lh)*cos(psi)*cos(theta))*sin(phi_lh) + sin(phi)*sin(theta)*cos(phi_lh))*cos(theta_lh) + (sin(phi)*sin(psi)*sin(psi_lh)*cos(theta) - sin(phi)*cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*cos(theta_lk))) - yd], 
    [-phi_lhd*(-l1*(1 - cos(theta_lk))*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(phi_lh) - sin(phi_lh)*cos(phi)*cos(theta))*cos(theta_lh) - l1*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(phi_lh) - sin(phi_lh)*cos(phi)*cos(theta))*sin(theta_lh)*sin(theta_lk) + w*(-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta)) + w*(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) - w*cos(phi)*cos(phi_lh)*cos(theta) + (-l1 - l2)*(-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(phi_lh) - sin(phi_lh)*cos(phi)*cos(theta))*sin(theta_lh)*sin(theta_lk) + (((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(phi_lh) - sin(phi_lh)*cos(phi)*cos(theta))*cos(theta_lh)*cos(theta_lk))) - phid*(-l1*(1 - cos(theta_lk))*(((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh)) - l1*(((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh)) + w*(1 - cos(psi_lh))*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi)) + w*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*cos(phi_lh) - sin(phi)*sin(phi_lh)*cos(theta)) + w*(sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_lh) + w*sin(phi)*sin(phi_lh)*cos(theta) + (-l1 - l2)*((-((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + (((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*sin(psi_lh))*sin(phi_lh) - sin(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_lh))*sin(theta_lh))*cos(theta_lk))) - psi_lhd*(-l1*(1 - cos(theta_lk))*((-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*cos(theta_lh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(theta_lh)) - l1*((-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*sin(theta_lh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh)) + w*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(phi_lh) + w*(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + w*(sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh) + (-l1 - l2)*((-(-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*sin(theta_lh) - (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(theta_lh))*sin(theta_lk) + ((-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*cos(theta_lh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(theta_lh))*cos(theta_lk))) - psid*(-l1*(1 - cos(theta_lk))*((-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(theta_lh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*cos(theta_lh)) - l1*(((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(theta_lh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*sin(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh)) + w*(1 - cos(psi_lh))*(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi)) + w*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(phi_lh) + w*(sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh) + (-l1 - l2)*(((-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(theta_lh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*cos(theta_lh))*cos(theta_lk) + (-((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*cos(theta_lh) - (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(phi_lh)*sin(theta_lh))*sin(theta_lk))) - theta_lhd*(-l1*(1 - cos(theta_lk))*(-(-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh)) - l1*((-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh))*cos(theta_lk) + (-(-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh))*sin(theta_lk))) - theta_lkd*(-l1*((-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh))*cos(theta_lk) - l1*((-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh))*sin(theta_lk) + (-l1 - l2)*((-(-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*sin(theta_lh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*cos(theta_lh))*cos(theta_lk) - ((-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_lh))*sin(phi_lh) + cos(phi)*cos(phi_lh)*cos(theta))*cos(theta_lh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_lh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_lh))*sin(theta_lh))*sin(theta_lk))) - thetad*(-l1*(1 - cos(theta_lk))*(((-sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_lh) - sin(theta)*cos(phi)*cos(phi_lh))*cos(theta_lh) + (-sin(psi)*sin(psi_lh)*cos(phi)*cos(theta) + cos(phi)*cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh)) - l1*(((-sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_lh) - sin(theta)*cos(phi)*cos(phi_lh))*sin(theta_lh) + (sin(psi)*sin(psi_lh)*cos(phi)*cos(theta) - cos(phi)*cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*sin(theta_lk) + w*(1 - cos(phi_lh))*(sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(phi)*cos(psi)*cos(theta)) + w*(1 - cos(psi_lh))*sin(psi)*cos(phi)*cos(theta) + w*((sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) + sin(psi_lh)*cos(phi)*cos(psi)*cos(theta))*cos(phi_lh) - sin(phi_lh)*sin(theta)*cos(phi)) + w*sin(phi_lh)*sin(theta)*cos(phi) - w*sin(psi_lh)*cos(phi)*cos(psi)*cos(theta) + (-l1 - l2)*((-((-sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_lh) - sin(theta)*cos(phi)*cos(phi_lh))*sin(theta_lh) - (sin(psi)*sin(psi_lh)*cos(phi)*cos(theta) - cos(phi)*cos(psi)*cos(psi_lh)*cos(theta))*cos(theta_lh))*sin(theta_lk) + (((-sin(psi)*cos(phi)*cos(psi_lh)*cos(theta) - sin(psi_lh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_lh) - sin(theta)*cos(phi)*cos(phi_lh))*cos(theta_lh) + (-sin(psi)*sin(psi_lh)*cos(phi)*cos(theta) + cos(phi)*cos(psi)*cos(psi_lh)*cos(theta))*sin(theta_lh))*cos(theta_lk))) - zd], 
    [0]
])

Matrix([
    [-phi_rhd*(-l1*(1 - cos(theta_rk))*((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(phi_rh) - sin(phi_rh)*sin(theta))*cos(theta_rh) - l1*((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(phi_rh) - sin(phi_rh)*sin(theta))*sin(theta_rh)*sin(theta_rk) - w*(-(-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) - sin(theta)*cos(phi_rh)) - w*(-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) - w*sin(theta)*cos(phi_rh) + (-l1 - l2)*(-((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(phi_rh) - sin(phi_rh)*sin(theta))*sin(theta_rh)*sin(theta_rk) + ((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(phi_rh) - sin(phi_rh)*sin(theta))*cos(theta_rh)*cos(theta_rk))) - psi_rhd*(-l1*(1 - cos(theta_rk))*((sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*cos(theta_rh) + (-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(theta_rh)) - l1*((sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*sin(theta_rh) + (sin(psi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(psi)*cos(theta))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta)) - w*(sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*cos(phi_rh) + w*sin(psi)*sin(psi_rh)*cos(theta) + w*cos(psi)*cos(psi_rh)*cos(theta) + (-l1 - l2)*((-(sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*sin(theta_rh) - (sin(psi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(psi)*cos(theta))*cos(theta_rh))*sin(theta_rk) + ((sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*cos(theta_rh) + (-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(theta_rh))*cos(theta_rk))) - psid*(-l1*(1 - cos(theta_rk))*((-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*cos(theta_rh) + (sin(psi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(psi)*cos(theta))*sin(theta_rh)) - l1*((-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*sin(theta_rh) + (-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta)) + w*(1 - cos(psi_rh))*cos(psi)*cos(theta) - w*(-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*cos(phi_rh) - w*sin(psi)*sin(psi_rh)*cos(theta) + (-l1 - l2)*((-(-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*sin(theta_rh) - (-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*cos(theta_rh))*sin(theta_rk) + ((-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*sin(phi_rh)*cos(theta_rh) + (sin(psi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(psi)*cos(theta))*sin(theta_rh))*cos(theta_rk))) - theta_rhd*(-l1*(1 - cos(theta_rk))*(-((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*sin(theta_rh) + (-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh)) - l1*(((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*cos(theta_rh) - (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*sin(theta_rh) + (-sin(psi)*sin(psi_rh)*cos(theta) - cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*cos(theta_rk) + (-((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*cos(theta_rh) + (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*sin(theta_rk))) - theta_rkd*(-l1*(((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*sin(theta_rh) + (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*cos(theta_rk) - l1*(((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*cos(theta_rh) - (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*sin(theta_rh) - (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*cos(theta_rk) - (((-sin(psi)*cos(psi_rh)*cos(theta) + sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(theta)*cos(phi_rh))*cos(theta_rh) - (sin(psi)*sin(psi_rh)*cos(theta) + cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*sin(theta_rk))) - thetad*(-l1*(1 - cos(theta_rk))*(((sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi))*sin(phi_rh) + cos(phi_rh)*cos(theta))*cos(theta_rh) + (sin(psi)*sin(psi_rh)*sin(theta) + sin(theta)*cos(psi)*cos(psi_rh))*sin(theta_rh)) - l1*(((sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi))*sin(phi_rh) + cos(phi_rh)*cos(theta))*sin(theta_rh) + (-sin(psi)*sin(psi_rh)*sin(theta) - sin(theta)*cos(psi)*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi)) - w*(1 - cos(psi_rh))*sin(psi)*sin(theta) - w*((sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi))*cos(phi_rh) - sin(phi_rh)*cos(theta)) - w*sin(phi_rh)*cos(theta) - w*sin(psi_rh)*sin(theta)*cos(psi) + (-l1 - l2)*((-((sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi))*sin(phi_rh) + cos(phi_rh)*cos(theta))*sin(theta_rh) - (-sin(psi)*sin(psi_rh)*sin(theta) - sin(theta)*cos(psi)*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) + (((sin(psi)*sin(theta)*cos(psi_rh) - sin(psi_rh)*sin(theta)*cos(psi))*sin(phi_rh) + cos(phi_rh)*cos(theta))*cos(theta_rh) + (sin(psi)*sin(psi_rh)*sin(theta) + sin(theta)*cos(psi)*cos(psi_rh))*sin(theta_rh))*cos(theta_rk))) - xd], 
    [-phi_rhd*(-l1*(1 - cos(theta_rk))*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(phi_rh) + sin(phi)*sin(phi_rh)*cos(theta))*cos(theta_rh) - l1*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(phi_rh) + sin(phi)*sin(phi_rh)*cos(theta))*sin(theta_rh)*sin(theta_rk) - w*(-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) + sin(phi)*cos(phi_rh)*cos(theta)) - w*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) + w*sin(phi)*cos(phi_rh)*cos(theta) + (-l1 - l2)*(-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(phi_rh) + sin(phi)*sin(phi_rh)*cos(theta))*sin(theta_rh)*sin(theta_rk) + (((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(phi_rh) + sin(phi)*sin(phi_rh)*cos(theta))*cos(theta_rh)*cos(theta_rk))) - phid*(-l1*(1 - cos(theta_rk))*((((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh)) - l1*((((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + ((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh)) - w*(1 - cos(psi_rh))*(-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi)) - w*(((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(phi_rh) + sin(phi_rh)*cos(phi)*cos(theta)) + w*(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + w*sin(phi_rh)*cos(phi)*cos(theta) + (-l1 - l2)*((-(((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) - ((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) + ((((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + (-(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh))*cos(theta_rk))) - psi_rhd*(-l1*(1 - cos(theta_rk))*((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(theta_rh)) - l1*((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*sin(theta_rh) + ((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh)) - w*(-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(phi_rh) - w*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + w*(sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh) + (-l1 - l2)*((-(-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*sin(theta_rh) - ((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) + ((-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(theta_rh))*cos(theta_rk))) - psid*(-l1*(1 - cos(theta_rk))*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(theta_rh)) - l1*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*sin(theta_rh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh)) - w*(1 - cos(psi_rh))*(-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi)) - w*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh))*cos(phi_rh) + w*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-l1 - l2)*((-((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*sin(theta_rh) - ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(theta_rh))*sin(theta_rk) + (((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*sin(theta)*cos(psi) - sin(psi)*cos(phi))*cos(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(theta_rh))*cos(theta_rk))) - theta_rhd*(-l1*(1 - cos(theta_rk))*(-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh)) - l1*((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + ((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh))*cos(theta_rk) + (-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh))*sin(theta_rk))) - theta_rkd*(-l1*((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh))*cos(theta_rk) - l1*((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) - (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh))*cos(theta_rk) - ((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - (-(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh))*sin(theta_rk))) - thetad*(-l1*(1 - cos(theta_rk))*(((-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(phi)*sin(theta)*cos(phi_rh))*cos(theta_rh) + (-sin(phi)*sin(psi)*sin(psi_rh)*cos(theta) - sin(phi)*cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh)) - l1*(((-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(phi)*sin(theta)*cos(phi_rh))*sin(theta_rh) + (sin(phi)*sin(psi)*sin(psi_rh)*cos(theta) + sin(phi)*cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta)) + w*(1 - cos(psi_rh))*sin(phi)*sin(psi)*cos(theta) - w*((-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta))*cos(phi_rh) - sin(phi)*sin(phi_rh)*sin(theta)) - w*sin(phi)*sin(phi_rh)*sin(theta) + w*sin(phi)*sin(psi_rh)*cos(psi)*cos(theta) + (-l1 - l2)*((-((-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(phi)*sin(theta)*cos(phi_rh))*sin(theta_rh) - (sin(phi)*sin(psi)*sin(psi_rh)*cos(theta) + sin(phi)*cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*sin(theta_rk) + (((-sin(phi)*sin(psi)*cos(psi_rh)*cos(theta) + sin(phi)*sin(psi_rh)*cos(psi)*cos(theta))*sin(phi_rh) + sin(phi)*sin(theta)*cos(phi_rh))*cos(theta_rh) + (-sin(phi)*sin(psi)*sin(psi_rh)*cos(theta) - sin(phi)*cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*cos(theta_rk))) - yd], 
    [-phi_rhd*(-l1*(1 - cos(theta_rk))*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(phi_rh) - sin(phi_rh)*cos(phi)*cos(theta))*cos(theta_rh) - l1*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(phi_rh) - sin(phi_rh)*cos(phi)*cos(theta))*sin(theta_rh)*sin(theta_rk) - w*(-((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - cos(phi)*cos(phi_rh)*cos(theta)) - w*((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) - w*cos(phi)*cos(phi_rh)*cos(theta) + (-l1 - l2)*(-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(phi_rh) - sin(phi_rh)*cos(phi)*cos(theta))*sin(theta_rh)*sin(theta_rk) + (((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(phi_rh) - sin(phi_rh)*cos(phi)*cos(theta))*cos(theta_rh)*cos(theta_rk))) - phid*(-l1*(1 - cos(theta_rk))*((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh)) - l1*((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + ((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh)) - w*(1 - cos(psi_rh))*(-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi)) - w*(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*cos(phi_rh) + sin(phi)*sin(phi_rh)*cos(theta)) + w*(sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh) + w*sin(phi)*sin(phi_rh)*cos(theta) + (-l1 - l2)*((-(((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) - ((sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) + ((((-sin(phi)*sin(psi)*sin(theta) + cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*sin(psi_rh))*sin(phi_rh) - sin(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + (-(sin(phi)*sin(psi)*sin(theta) - cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*sin(theta)*cos(psi) + sin(psi)*cos(phi))*cos(psi_rh))*sin(theta_rh))*cos(theta_rk))) - psi_rhd*(-l1*(1 - cos(theta_rk))*(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*cos(theta_rh)) - l1*((-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*sin(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh)) - w*((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(phi_rh) + w*(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - w*(sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh) + (-l1 - l2)*((-(-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*sin(theta_rh))*sin(theta_rk) + (((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) - (-sin(phi)*cos(psi) - sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*cos(theta_rh))*cos(theta_rk))) - psid*(-l1*(1 - cos(theta_rk))*(((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(theta_rh)) - l1*(((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*sin(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh)) - w*(1 - cos(psi_rh))*(-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi)) - w*((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(phi_rh) + w*(sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh) + (-l1 - l2)*((-((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*sin(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*cos(theta_rh))*sin(theta_rk) + (((-sin(phi)*sin(psi) + sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(phi_rh)*cos(theta_rh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(theta_rh))*cos(theta_rk))) - theta_rhd*(-l1*(1 - cos(theta_rk))*(-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh)) - l1*((((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + (-(sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh))*cos(theta_rk) + (-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh))*sin(theta_rk))) - theta_rkd*(-l1*((((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) + ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh))*cos(theta_rk) - l1*((((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh))*sin(theta_rk) + (-l1 - l2)*((-(((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*sin(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*cos(theta_rh))*cos(theta_rk) - ((((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*sin(psi_rh) + (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*cos(psi_rh))*sin(phi_rh) + cos(phi)*cos(phi_rh)*cos(theta))*cos(theta_rh) - ((sin(phi)*sin(psi) - sin(theta)*cos(phi)*cos(psi))*cos(psi_rh) - (sin(phi)*cos(psi) + sin(psi)*sin(theta)*cos(phi))*sin(psi_rh))*sin(theta_rh))*sin(theta_rk))) - thetad*(-l1*(1 - cos(theta_rk))*(((sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_rh) - sin(theta)*cos(phi)*cos(phi_rh))*cos(theta_rh) + (sin(psi)*sin(psi_rh)*cos(phi)*cos(theta) + cos(phi)*cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh)) - l1*(((sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_rh) - sin(theta)*cos(phi)*cos(phi_rh))*sin(theta_rh) + (-sin(psi)*sin(psi_rh)*cos(phi)*cos(theta) - cos(phi)*cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*sin(theta_rk) - w*(1 - cos(phi_rh))*(sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta)) - w*(1 - cos(psi_rh))*sin(psi)*cos(phi)*cos(theta) - w*((sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta))*cos(phi_rh) + sin(phi_rh)*sin(theta)*cos(phi)) + w*sin(phi_rh)*sin(theta)*cos(phi) - w*sin(psi_rh)*cos(phi)*cos(psi)*cos(theta) + (-l1 - l2)*((-((sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_rh) - sin(theta)*cos(phi)*cos(phi_rh))*sin(theta_rh) - (-sin(psi)*sin(psi_rh)*cos(phi)*cos(theta) - cos(phi)*cos(psi)*cos(psi_rh)*cos(theta))*cos(theta_rh))*sin(theta_rk) + (((sin(psi)*cos(phi)*cos(psi_rh)*cos(theta) - sin(psi_rh)*cos(phi)*cos(psi)*cos(theta))*sin(phi_rh) - sin(theta)*cos(phi)*cos(phi_rh))*cos(theta_rh) + (sin(psi)*sin(psi_rh)*cos(phi)*cos(theta) + cos(phi)*cos(psi)*cos(psi_rh)*cos(theta))*sin(theta_rh))*cos(theta_rk))) - zd], 
    [0]
])
